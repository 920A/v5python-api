*Updated to James Pearman's documented version because the one I wrote was incomplete
